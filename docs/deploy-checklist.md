# Чек-лист перед деплоем и выкладкой на GitHub

## Безопасность

- [ ] Файл `.env` **не коммитится** (уже в `.gitignore`). Проверьте: `git status` не должен показывать `.env`.
- [ ] В репозитории только `.env.example` с **плейсхолдерами**. Реальные ключи — только в `.env` локально и в переменных окружения на сервере.
- [ ] Если старый `.env` или реальные ключи когда-то попали в историю git — **смените все ключи** (Supabase: новый anon/service_role, Resend, Telegram и т.д.) и при необходимости почистите историю.

## Переменные окружения на сервере

- [ ] **Сборка образа**: в Dokploy при сборке образа передать **Build Args**: `NEXT_PUBLIC_SUPABASE_URL` и `NEXT_PUBLIC_SUPABASE_ANON_KEY` (Next.js подставляет их в бандл при `npm run build`; без них middleware получит пустые значения).
- [ ] **Рантайм**: у сервиса в Environment Variables тоже задать эти переменные (для единообразия и на случай серверного кода).
- [ ] Значения — из панели Supabase (Project URL и Anon Key). **URL должен быть HTTPS**, если приложение открывается по HTTPS (иначе Mixed Content и «Failed to fetch»).
- [ ] `SUPABASE_SERVICE_ROLE_KEY` — только на сервере, не отдавать на клиент.
- [ ] `MFA_COOKIE_SECRET` — задан в production (иначе приложение выбросит ошибку при проверке 2FA).
- [ ] `DATABASE_URL` — для Prisma (миграции / db push), если используете.

## Проверка перед пушем в GitHub

- [ ] `npm run build` — успешно.
- [ ] В коде нет хардкода паролей, API-ключей, полных JWT.
- [ ] Запросы к своему API — относительные (`/api/...`), без захардкоженного хоста.
