# Выкладка Модуль.Пульс на сервер

Код нужно залить на тот же сервер, с которого вы его скачивали (или где уже крутится pulse.module.team), собрать образ и запустить контейнер.

## 1. Код на сервере

**Вариант А: репозиторий на сервере уже есть**

```powershell
# На сервере (SSH) в каталоге проекта
cd /path/to/pulse
git pull
```

**Вариант Б: первый раз или клонируете заново**

На сервере (по SSH):

```bash
cd /home/your-user   # или куда принято класть проекты
git clone https://github.com/ваш-org/pulse.git
cd pulse
```

**Вариант В: без git — архивом**

На своей машине соберите архив (без `node_modules` и `.next`), залейте на сервер (SCP, SFTP, WinSCP и т.п.), распакуйте в нужную папку.

---

## 2. Переменные окружения на сервере

В каталоге проекта создайте `.env` (если ещё нет) и заполните по `.env.example`:

- `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY` — из Supabase
- `SUPABASE_SERVICE_ROLE_KEY` — для серверных операций
- `MFA_COOKIE_SECRET` — случайная строка 32+ символов для production
- при необходимости: `DATABASE_URL`, `RESEND_*`, `TELEGRAM_GATEWAY_TOKEN` и т.д.

Не коммитьте `.env` в git. На сервере файл создаётся вручную или через панель деплоя.

---

## 3. Сборка и запуск (Docker)

На сервере в каталоге проекта:

```bash
# Сборка образа и запуск
docker compose up -d --build
```

Приложение будет слушать порт **3000**. Проверка: `curl http://localhost:3000` или открыть в браузере по домену, который указывает на этот сервер (например https://pulse.module.team, если перед приложением стоит nginx/прокси с SSL).

Остановка:

```bash
docker compose down
```

Пересборка после изменений кода:

```bash
git pull
docker compose up -d --build
```

---

## 4. Если используете Dokploy

- Создайте приложение из репозитория (Git) или из папки на сервере.
- Тип: Dockerfile (путь к Dockerfile в корне репозитория).
- В настройках приложения задайте переменные окружения (как в `.env`).
- Порт контейнера: 3000; домен pulse.module.team настраивается в Dokploy или в обратном прокси (nginx/traefik).

После пуша в репозиторий Dokploy может сам делать пересборку и редеплой, если включён автодеплой.
